{"version":3,"file":"cart.js","sources":["../src/js/storage.js","../src/cart.js"],"sourcesContent":["import { STORAGE_KEYS } from './constants';\n\nexport function saveToLocalStorage(key, data) {\n  try {\n    localStorage.setItem(key, JSON.stringify(data));\n  } catch (error) {\n    console.log(`Error saving data to LS: ${error.message}`);\n  }\n}\n\nexport function getFromLocalStorage(key) {\n  try {\n    const data = localStorage.getItem(key);\n    return data ? JSON.parse(data) : null;\n  } catch (error) {\n    console.log(`Error getting data from LS: ${error.message}`);\n    return null;\n  }\n}\nexport function getWishlistItems() {\n  return getFromLocalStorage(STORAGE_KEYS.WISHLIST) || [];\n}\n\nexport function saveCart(cart) {\n  localStorage.setItem(STORAGE_KEYS.cart, JSON.stringify(cart));\n}\nexport function getCart() {\n  return JSON.parse(localStorage.getItem(STORAGE_KEYS.cart)) || [];\n}\n\nexport function updateNavCounts() {\n  const cartCountElement = document.querySelector('[data-cart-count]');\n  const wishlistCountElement = document.querySelector('[data-wishlist-count]');\n\n  const cart = getCart();\n  const wishlist = getWishlistItems();\n\n  if (cartCountElement) {\n    cartCountElement.textContent = cart.length;\n  }\n\n  if (wishlistCountElement) {\n    wishlistCountElement.textContent = wishlist.length;\n  }\n}\n\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { getCart, saveCart, updateNavCounts } from './js/storage.js';\nimport { getProductById } from './js/products-api.js';\nimport { renderProducts, showLoader, showNotFound } from './js/render-function.js';\nimport { onProductClick } from './js/handlers';\n\nconst refs = {\n    productsList: document.querySelector('.products'),\n    itemsCount: document.querySelector('[data-count]'),\n    totalPrice: document.querySelector('[data-price]'),\n    buyBtn: document.querySelector('.cart-summary__btn'),\n    notFound: document.querySelector('.not-found'),\n};\n\n// Инициализация \nasync function init() {\n    showLoader(true);\n    const ids = getCart('cart') || [];\n\n    if (ids.length === 0) {\n        refs.productsList.innerHTML = '';\n        showNotFound(true);\n        updateSummary(0, 0);\n        showLoader(false);\n        updateNavCounts();\n        return;\n    }\n\n    try {\n        const products = await Promise.all(ids.map(id => getProductById(id)));\n        renderProducts(products);\n        showNotFound(false);\n\n        const totalItems = products.length;\n        const totalPrice = products.reduce((sum, p) => sum + p.price, 0).toFixed(2);\n        updateSummary(totalItems, totalPrice);\n\n    } catch (error) {\n        console.error('Cart load error:', error);\n        iziToast.error({\n            title: 'Error',\n            message: 'Failed to load products',\n            position: 'topRight',\n        });\n        showNotFound(true);\n        \n    } finally {\n        showLoader(false); \n    }\n}\n\n// Обновление итогов\nfunction updateSummary(items, price) {\n    refs.itemsCount.textContent = items;\n    refs.totalPrice.textContent = `$${price}`;\n}\n\n// Перезагрузка корзины\nfunction refreshCart() {\n    const ids = getCart('cart') || [];\n    saveCart(ids);        \n    updateNavCounts();    \n    init();              \n}\n\nrefs.productsList?.addEventListener('click', (e) => {\n    onProductClick(e);\n    setTimeout(refreshCart, 100);\n});\n\nrefs.buyBtn?.addEventListener('click', () => {\n    iziToast.success({\n        title: 'Success!',\n        message: 'Purchase successful!',\n        position: 'topRight',\n    });\n\n    localStorage.removeItem('cart');\n    updateNavCounts();\n    init();\n});\n\ninit();\n\n"],"names":["getFromLocalStorage","key","data","error","getWishlistItems","STORAGE_KEYS","saveCart","cart","getCart","updateNavCounts","cartCountElement","wishlistCountElement","wishlist","refs","init","showLoader","ids","showNotFound","updateSummary","products","id","getProductById","renderProducts","totalItems","totalPrice","sum","iziToast","items","price","refreshCart","_a","e","onProductClick"],"mappings":"+JAUO,SAASA,EAAoBC,EAAK,CACvC,GAAI,CACF,MAAMC,EAAO,aAAa,QAAQD,CAAG,EACrC,OAAOC,EAAO,KAAK,MAAMA,CAAI,EAAI,IAClC,OAAQC,EAAO,CACd,eAAQ,IAAI,+BAA+BA,EAAM,OAAO,EAAE,EACnD,IACR,CACH,CACO,SAASC,GAAmB,CACjC,OAAOJ,EAAoBK,EAAa,QAAQ,GAAK,CAAA,CACvD,CAEO,SAASC,EAASC,EAAM,CAC7B,aAAa,QAAQF,EAAa,KAAM,KAAK,UAAUE,CAAI,CAAC,CAC9D,CACO,SAASC,GAAU,CACxB,OAAO,KAAK,MAAM,aAAa,QAAQH,EAAa,IAAI,CAAC,GAAK,EAChE,CAEO,SAASI,GAAkB,CAChC,MAAMC,EAAmB,SAAS,cAAc,mBAAmB,EAC7DC,EAAuB,SAAS,cAAc,uBAAuB,EAErEJ,EAAOC,IACPI,EAAWR,IAEbM,IACFA,EAAiB,YAAcH,EAAK,QAGlCI,IACFA,EAAqB,YAAcC,EAAS,OAEhD,CCpCA,MAAMC,EAAO,CACT,aAAc,SAAS,cAAc,WAAW,EAChD,WAAY,SAAS,cAAc,cAAc,EACjD,WAAY,SAAS,cAAc,cAAc,EACjD,OAAQ,SAAS,cAAc,oBAAoB,EACnD,SAAU,SAAS,cAAc,YAAY,CACjD,EAGA,eAAeC,GAAO,CAClBC,EAAW,EAAI,EACf,MAAMC,EAAMR,EAAc,GAAK,GAE/B,GAAIQ,EAAI,SAAW,EAAG,CAClBH,EAAK,aAAa,UAAY,GAC9BI,EAAa,EAAI,EACjBC,EAAc,EAAG,CAAC,EAClBH,EAAW,EAAK,EAChBN,IACA,MACH,CAED,GAAI,CACA,MAAMU,EAAW,MAAM,QAAQ,IAAIH,EAAI,IAAII,GAAMC,EAAeD,CAAE,CAAC,CAAC,EACpEE,EAAeH,CAAQ,EACvBF,EAAa,EAAK,EAElB,MAAMM,EAAaJ,EAAS,OACtBK,EAAaL,EAAS,OAAO,CAACM,EAAK,IAAMA,EAAM,EAAE,MAAO,CAAC,EAAE,QAAQ,CAAC,EAC1EP,EAAcK,EAAYC,CAAU,CAEvC,OAAQrB,EAAO,CACZ,QAAQ,MAAM,mBAAoBA,CAAK,EACvCuB,EAAS,MAAM,CACX,MAAO,QACP,QAAS,0BACT,SAAU,UACtB,CAAS,EACDT,EAAa,EAAI,CAEzB,QAAc,CACNF,EAAW,EAAK,CACnB,CACL,CAGA,SAASG,EAAcS,EAAOC,EAAO,CACjCf,EAAK,WAAW,YAAcc,EAC9Bd,EAAK,WAAW,YAAc,IAAIe,CAAK,EAC3C,CAGA,SAASC,GAAc,CACnB,MAAMb,EAAMR,EAAc,GAAK,GAC/BF,EAASU,CAAG,EACZP,IACAK,GACJ,QAEAgB,EAAAjB,EAAK,eAAL,MAAAiB,EAAmB,iBAAiB,QAAUC,GAAM,CAChDC,EAAeD,CAAC,EAChB,WAAWF,EAAa,GAAG,CAC/B,UAEAC,EAAAjB,EAAK,SAAL,MAAAiB,EAAa,iBAAiB,QAAS,IAAM,CACzCJ,EAAS,QAAQ,CACb,MAAO,WACP,QAAS,uBACT,SAAU,UAClB,CAAK,EAED,aAAa,WAAW,MAAM,EAC9BjB,IACAK,GACJ,GAEAA,EAAM"}